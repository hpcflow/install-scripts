name: Integration test - Matflow, BASH, Linux
on:
  workflow_dispatch:

jobs:
  int-test-script-bash-linux:
    runs-on: ubuntu-latest

    steps:

      - name: Checkout
        uses: actions/checkout@v3

      - name: Run script
        id: run-script
        run: |
          script_output=`(touch tmp.sh && curl -fsSL https://raw.githubusercontent.com/hpcflow/install-scripts/main/src/install-matflow.sh > tmp.sh && bash tmp.sh --prerelease --path --onefile) ; rm tmp.sh`
          artifact_name=`echo $script_output | grep matflow- | cut -d " " -f 6`
          echo "ARTIFACT_NAME=${artifact_name}" >> "$GITHUB_OUTPUT"

      - name: Run Matflow test suite
        run: ~/.local/share/matflow/${{ steps.run-script.outputs.ARTIFACT_NAME }} test



